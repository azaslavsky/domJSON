<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>domJSON</title>

	<!-- Bootstrap Core CSS -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">

	<!-- FontAwesome -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"></link>

	<!-- OpenSans -->
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400' rel='stylesheet' type='text/css'>

	<!-- Custom CSS -->
	<link href="./css/demo.css" rel="stylesheet">

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
	<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
	<![endif]-->

	</head>

<body>

	<div id="wrapper">

		<!-- Sidebar -->
		<div id="sidebar-wrapper">
			<ul class="sidebar-nav">
				<li class="sidebar-brand">
					<a href="#top">
						domJSON
					</a>
				</li>
				<li>
					<a href="#whatfor">What's it for?</a>
				</li>
				<li>
					<a href="#startup">Getting Started</a>
				</li>
				<li>
					<a href="#api">API Options</a>
				</li>
				<li>
					<a href="#makejson">Sample: Make Some JSON</a>
				</li>
				<li>
					<a href="#webworkers">Sample: Speedy Web Workers</a>
				</li>
				<li>
					<a href="#contributing">Contributing, Tests, etc</a>
				</li>
			</ul>
		</div>
		<!-- /#sidebar-wrapper -->

		<!-- Page Content -->
		<div id="page-content-wrapper">
			<a class="forkme" target="_blank" href="https://github.com/azaslavsky/domJSON"><img src="./img/fork.png"></img></a>
			<div id="sidebar-toggle">
				<i class="sidebar-icon fa fa-close"></i>
			</div>
			<div class="container-fluid">
				<div class="row">
					<div class="col-lg-12" id="top">
						<h1>domJSON v0.1.1</h1>
						<p>Convert DOM trees into compact JSON objects, and vice versa, as fast as possible.</p>
						<a style="display: none" href="#menu-toggle" class="btn btn-default" id="menu-toggle">Toggle Menu</a>
					</div>
				</div>

				<div class="row">
					<div class="col-lg-12" id="whatfor">
						<h2>What is domJSON for?</h2>

						<p>The purpose of domJSON is to produce very accurate representations of the DOM as JSON objects, and to do it very quickly.  Broadly speaking, the goals of this project are:</p>

						<ul>
							<li>Provide as accurate a copy of a given node's DOM properties as possible, but allow optional filtering to remove useless information</li>
							<li>Be able to rebuild JSON nodes into DOM nodes as performantly as possible</li>
							<li>Speed, speed, speed</li>
							<li>No frivolous data: produce JSON objects that are as compact as possible, removing all information not relevant to the developer</li>
							<li>Keep the library lightweight, with no dependencies</li>
						</ul>

						<p>DomJSON works in the following browsers (mobile and desktop versions supported):</p>

						<ul style="list-style-type: none; padding-left: 0px;">
							<li><img src="./img/chrome.png"/>Chrome 36+</li>
							<li><img src="./img/ff.png"/>Firefox 24+</li>
							<li><img src="./img/safari.png"/>Safari 7+</li>
							<li><img src="./img/ie.png"/>Internet Explorer 9+</li>
						</ul>

						<p>While there are probably dozens of varied use cases for this project, two stick out in my mind.  The first is as a front-end debugging or snapshotting tool, which would allow end users to send reports that include "snapshots" of the DOM at any given point in time.  Imagine an <b>"I Found a Bug!"</b> button on your web app, which, when clicked, would send an easily rebuildable copy of the DOM in its current state (computed styles included!) to the dev team.  DomJSON can do that - to take a peek, check out the <a href="#makejson">first example.</a>  Another potential use case is as a poor man's <a target"_blank" href="http://stackoverflow.com/a/21117404/2230156">virtual DOM</a>, allowing domJSON to do batch updates on your DOM tree much quicker than normal.  Check out the second example <a href="#webworkers">for a demonstration.</a>  I'm sure there are plenty of other use cases for domJSON  that I'm not even considering, but these are the two that make the most sense at first glance.</p>
					</div>
				</div>

				<div class="row">
					<div class="col-lg-12" id="startup">
						<h2>Getting Started</h2>
						<p>Installing domJSON is easy. You can pull it from Bower...</p>

						<div class="codeblock lang bash">
							<pre>
								<code>bower install domjson</code>
							</pre>
						</div>
						<div class="codeblock lang html">
							<pre>
								<span style='color:#ffdc99; '>&lt;</span><span style='color:#e66170; font-weight:bold; '>script src="<span style="color: #d1d1d1;">bower_components/domjson/dist/domjson.min.js</span>"</span><span style='color:#ffdc99; '>></span><span style='color:#ffdc99; '>&lt;/</span><span style='color:#e66170; font-weight:bold; '>script</span><span style='color:#ffdc99; '>></span>
							</pre>
						</div>

						<p>...or grab it from NPM and manually include it as a script tag.</p>

						<div class="codeblock lang bash">
							<pre>
								<code>npm install domjson --save</code>
							</pre>
						</div>
						<div class="codeblock lang html">
							<pre>
								<span style='color:#ffdc99; '>&lt;</span><span style='color:#e66170; font-weight:bold; '>script src="<span style="color: #d1d1d1;">node_modules/domjson/dist/domjson.min.js</span>"</span><span style='color:#ffdc99; '>></span><span style='color:#ffdc99; '>&lt;/</span><span style='color:#e66170; font-weight:bold; '>script</span><span style='color:#ffdc99; '>></span>
							</pre>
						</div>

						<p>Of course, you can also do it the old fashioned way and just download it <a target="_blank" href="https://github.com/azaslavsky/domJSON">directly from Github</a>, then include the script tag.  Once you've got domJSON installed, working with it is super easy: use the <b>.toJSON()</b> method to create a JSON representation of the DOM tree:</p>

						<div class="codeblock lang js">
							<pre>
								<div class="lang">Javascript</div><span style='color:#e66170; font-weight:bold; '>var</span> someDOMElement <span style='color:#d2cd86; '>=</span> document<span style='color:#d2cd86; '>.</span>getElementById<span style='color:#d2cd86; '>(</span><span style='color:#00c4c4; '>'sampleId'</span><span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
								<span style='color:#e66170; font-weight:bold; '>var</span> jsonOutput <span style='color:#d2cd86; '>=</span> domJSON<span style='color:#d2cd86; '>.</span>toJSON<span style='color:#d2cd86; '>(</span>myDiv<span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
							</pre>
						</div>

						<p>And then rebuild the DOM Node from that JSON using <b>.toDOM()</b>:</p>

						<div class="codeblock lang js">
							<pre>
								<span style='color:#e66170; font-weight:bold; '>var</span> DOMDocumentFragment <span style='color:#d2cd86; '>=</span> domJSON<span style='color:#d2cd86; '>.</span>toDOM<span style='color:#d2cd86; '>(</span>jsonOutput<span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
								someDOMElement<span style='color:#d2cd86; '>.</span>parentNode<span style='color:#d2cd86; '>.</span>replaceChild<span style='color:#d2cd86; '>(</span>someDOMElement<span style='color:#d2cd86; '>,</span> DOMDocumentFragment<span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
							</pre>
						</div>

						<p>When creating the JSON object, there are many precise options available, ensuring that developers can produce very specific and compact outputs. For example, the following will produce a JSON copy of <span class="inline-code">someDOMElement</span>'s DOM tree that is only two levels deep, contains no "offset," "client," or "scroll*" type DOM properties, only keeps the "id" attribute on each DOM Node, and outputs a string (rather than a JSON-friendly object):</p>

						<div class="codeblock lang js">	
							<pre class="indented">
								<span style='color:#e66170; font-weight:bold; '>var</span> jsonOutput <span style='color:#d2cd86; '>=</span> domJSON<span style='color:#d2cd86; '>.</span>toJSON<span style='color:#d2cd86; '>(</span>myDiv<span style='color:#d2cd86; '>,</span> <span style='color:#b060b0; '>{</span>
								    attributes<span style='color:#b060b0; '>:</span> <span style='color:#d2cd86; '>[</span><span style='color:#00c4c4; '>'id'</span><span style='color:#d2cd86; '>]</span><span style='color:#d2cd86; '>,</span>
								    domProperties<span style='color:#b060b0; '>:</span> <span style='color:#b060b0; '>{</span>
								        exclude<span style='color:#b060b0; '>:</span> <span style='color:#0f4d75; '>true</span><span style='color:#d2cd86; '>,</span>
								        values<span style='color:#b060b0; '>:</span> <span style='color:#d2cd86; '>[</span><span style='color:#00c4c4; '>'clientHeight'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'clientLeft'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'clientTop'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'offsetWidth'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'offsetHeight'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'offsetLeft'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'offsetTop'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'offsetWidth'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'scrollHeight'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'scrollLeft'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'scrollTop'</span><span style='color:#d2cd86; '>,</span> <span style='color:#00c4c4; '>'scrollWidth'</span><span style='color:#d2cd86; '>]</span>
								    <span style='color:#b060b0; '>}</span><span style='color:#d2cd86; '>,</span>
								    deep<span style='color:#b060b0; '>:</span> <span style='color:#008c00; '>2</span><span style='color:#d2cd86; '>,</span>
								    stringify<span style='color:#b060b0; '>:</span> <span style='color:#0f4d75; '>true</span>
								<span style='color:#b060b0; margin-left: -40px; '>}</span><span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
							</pre>
						</div>
					</div>
				</div>

				<div class="row">
					<div class="col-lg-12" id="api">
						<h2>API Options</h2>
						<p>Below is a list of all the <b>.toJSON()</b> options, and an explanation of what each one does:</p>

						<ul>
							<li><a href="#absolutePaths">absolutePaths</a></li>
							<li><a href="#attributes">attributes</a></li>
							<li><a href="#computedstyle">computedStyle</a></li>
							<li><a href="#cull">cull</a></li>
							<li><a href="#deep">deep</a></li>
							<li><a href="#domproperties">domProperties</a></li>
							<li><a href="#htmlonly">htmlOnly</a></li>
							<li><a href="#metadata">metadata</a></li>
							<li><a href="#serialproperties">serialProperties</a></li>
							<li><a href="#stringify">stringify</a></li>
						</ul>

						<div id="absolutepaths" class="apiopt">
							<h3>absolutePaths <span class="inline-code">Boolean|FilterList</span></h3>

							<p>Default: <span class="inline-code">['action', 'data', 'href', 'src']</span></p>

							<p>On most modern browsers, relative paths in DOM properties and CSS styles are converted to absolute paths during runtime.  Put another way, is you write <span class="inline-code">background: url('./something.png');</span> in a CSS file, you'll see <span class="inline-code">background: url('http://www.example.com/something.png');</span> when you query it while the app is running.  However, that same luxury is not provided for DOM attributes.  So, if you want to make sure all of the paths in the DOM attributes are absolute, set this option to <b>true</b>, or provide a <b><a target="_blank" href="https://github.com/azaslavsky/domJSON#filterlists">FilterList</a></b> of attributes to try and convert.  The default setup for this option should cover 99% of use cases.</p>

						</div>

						<div id="attributes" class="apiopt">
							<h3>attributes <span class="inline-code">Boolean|FilterList</span></h3>

							<p>Default: <span class="inline-code">true</span></p>

							<p>Set <b>true</b> to copy all DOM attributes, <b>false</b> to not copy any, or provide a <b><a target="_blank" href="https://github.com/azaslavsky/domJSON#filterlists">FilterList</a></b>.</p>
						</div>

						<div id="computedstyle" class="apiopt">
							<h3>computedStyle <span class="inline-code">Boolean|FilterList</span></h3>

							<p>Default: <span class="inline-code">false</span></p>

							<p>Set <b>true</b> to grab the computed styles for every DOM node in your tree, <b>false</b> to not copy any, or provide a <b><a target="_blank" href="https://github.com/azaslavsky/domJSON#filterlists">FilterList</a></b>.  Please that setting this to anything but <b>false</b> will cause a <i>significant</i> performance lag, since <span class="inline-code">window.getComputedStyle()</span> is <a target="_blank" href="http://jsperf.com/check-hidden/9">slow</a> <i>and</i> forces a redraw.  Use this option only if you absolutely need it!</p>
						</div>

						<div id="cull" class="apiopt">
							<h3>cull <span class="inline-code">Boolean</span></h3>

							<p>Default: <span class="inline-code">true</span></p>

							<p>Many, if not most, of the properties on any given DOM node are <b>null</b> or just empty strings.  Setting this option to true removes, or culls, all of those empty and redundant DOM properties from the final output.  It does <i>not</i> remove DOM properties whose value is <b>false</b> or <b>0</b>, since that is still useful information.</p>
						</div>

						<div id="deep" class="apiopt">
							<h3>deep <span class="inline-code">Boolean|Integer</span></h3>

							<p>Default: <span class="inline-code">true</span></p>

							<p>By default, the entire DOM tree will be parsed and turned into a JSON object.  But what if you only want to go two levels deep, or ignore child nodes completely?  In that case, set this value either to an <b>integer</b> describing how deep you want to recurse into the DOM tree, or <b>false</b> to completely ignore all children.</p>
						</div>

						<div id="domproperties" class="apiopt">
							<h3>domProperties <span class="inline-code">Boolean|FilterList</span></h3>

							<p>Default: <span class="inline-code">true</span></p>

							<p>Which DOM properties you'd like to copy.  Setting this <b>true</b> means that every DOM property will be copied, while <b>false</b> means that they will all be completely ignored.  You can also set a <b><a target="_blank" href="https://github.com/azaslavsky/domJSON#filterlists">FilterList</a></b> enumerating exactly which properties to include or exclude.  Remember, the properties <span class="inline-code">nodeType</span>, <span class="inline-code">nodeValue</span>, and <span class="inline-code">tagName</span> are copied no matter what (even if this options is set to <b>false</b>)!</p>
						</div>

						<div id="htmlonly" class="apiopt">
							<h3>htmlOnly <span class="inline-code">Boolean</span></h3>

							<p>Default: <span class="inline-code">true</span></p>

							<p>When this is <b>true</b>, only DOM Nodes of type 1 (HTML Elements) are copied.  This means that all comments AND all text content is ignored!</p>
						</div>

						<div id="metadata" class="apiopt">
							<h3>metadata <span class="inline-code">Boolean</span></h3>

							<p>Default: <span class="inline-code">true</span></p>

							<p>Controls whether or not to export metadata with the result.  It is <i>strongly</i> recommended that you leave this set to true, as it is possible that the output format will change slightly in future versions of domJSON, and it would be a real shame to you couldn't rebuild your JSON objects into DOM Nodes because you left out the metadata...</p>
						</div>

						<div id="serialproperties" class="apiopt">
							<h3>serialProperties <span class="inline-code">Boolean|FilterList</span></h3>

							<p>Default: <span class="inline-code">false</span></p>

							<p>Some DOM Nodes contain a few properties, notably <span class="inline-code">innertHTML</span> and <span class="inline-code">outerHTML</span>, simply contain serialized copies of the node's contents.  Copying this information essentially amounts to copying every DOM Node's contents twice over, and is very wasteful in terms of speed and JSON output size.  By setting this option to <b>false</b>, fields that are merely serializations of the DOM Node are ignored.  Conversely, <b>true</b> will copy all serialized properties, while a <b><a target="_blank" href="https://github.com/azaslavsky/domJSON#filterlists">FilterList</a></b> enumerates which serialized properties to include or exclude.  It is strongly recommended that you not change the default for this option unless you really need to keep the serializations, as including them has a seriously negative effect on performance.</p>
						</div>

						<div id="stringify" class="apiopt">
							<h3>stringify <span class="inline-code">Boolean</span></h3>

							<p>Default: <span class="inline-code">false</span></p>

							<p>When this is <b>true</b>, the output will be a string.  All it does is execute <span class="inline-code">JSON.stringify()</span> for you, so the following two statements will have an identical output:</p>

							<div class="codeblock lang js">
								<pre>
									domJSON<span style='color:#d2cd86; '>.</span>toJSON<span style='color:#d2cd86; '>(</span>someNode<span style='color:#d2cd86; '>,</span> <span style='color:#b060b0; '>{</span>stringify<span style='color:#b060b0; '>:</span> <span style='color:#0f4d75; '>true</span><span style='color:#b060b0; '>}</span><span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
									JSON<span style='color:#d2cd86; '>.</span>stringify<span style='color:#d2cd86; '>(</span> domJSON<span style='color:#d2cd86; '>.</span>toJSON<span style='color:#d2cd86; '>(</span>someNode<span style='color:#d2cd86; '>,</span> <span style='color:#b060b0; '>{</span>stringify<span style='color:#b060b0; '>:</span> <span style='color:#0f4d75; '>false</span><span style='color:#b060b0; '>}</span><span style='color:#d2cd86; '>)</span> <span style='color:#d2cd86; '>)</span><span style='color:#b060b0; '>;</span>
								</pre>
							</div>
						</div>

					</div>
				</div>

				<div class="row">
					<div class="col-lg-12" id="makejson">
						<h2>Sample: Turning the DOM into JSON</h2>
						<p>This is a simple example of how domJSON can take a DOM Tree (everything in the body of the iframe below), and turn it into a usable and representative JSON object.</p>
					</div>
				</div>

				<div class="row">
					<div class="col-lg-12" id="webworkers">
						<h2>Sample: Speeding Up Batch DOM Updates with Web Workers</h2>
						<p>In theory, rather than updating the DOM piecemeal, forcing a redraw each time, developers can grab a branch of the DOM tree and convert it to JSON.  They could make all of the changes in JS (which is much more performant than the DOM), then re-build a Document Fragment from this modified JSON. Finally, this new fragment could easily replace the DOM tree branch that's being worked on.</p>
					</div>
				</div>

				<div class="row">
					<div class="col-lg-12" id="contributing">
						<h2>Contributing</h2>
						<p>If you'd like to contribute, check out the <a target="_blank" href="https://github.com/azaslavsky/domJSON">Github repo</a>, but please make sure to check the <a target="_blank" href="https://github.com/azaslavsky/domJSON#contributing">contribution guidelines</a> before you make pull requests.</p>

						<p>Are you curious about compatibility with a browser not list above?  You can run the test suite <a target="_blank" href="https://github.com/azaslavsky/domJSON#tests">using the instructions here</a> to see if it passes - if it does, you're (probably) in the clear.  Please note that Internet Explorer 8 and lower is explicitly not supported.</p>

						<p>The domJSON library is published under the standard <a target="_blank" href="https://github.com/azaslavsky/domJSON#license">MIT License.</a></p>
					</div>
				</div>
			</div>

			<div id="footer">
				<span>&copy; Alex Zaslavsky, 2014</span>
				<a target="_blank" title="Email" href="mailto://alex.y.zaslavsky@gmail.com"><i class="fa fa-envelope" style="font-size: 19px; position: relative; top: 1px;"></i></a>
				<a target="_blank" title="Github" href="https://github.com/azaslavsky"><i class="fa fa-github-alt" style="font-size: 21px; position: relative; top: 1px;"></i></a>
				<a target="_blank" title="Stack Overflow" href="http://stackoverflow.com/users/2230156/alexz"><i class="fa fa-stack-overflow" style="font-size: 17px; position: relative; top: -1px;"></i></a>
				<a target="_blank" title="Twitter" href="https://twitter.com/alex__zaslavsky"><i class="fa fa-twitter" style="font-size: 22px; position: relative; top: 2px;"></i></a>
			</div>
		</div>
		<!-- /#page-content-wrapper -->

	</div>
	<!-- /#wrapper -->

	<!-- jQuery -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.1/js/bootstrap.min.js"></script>

	<!-- JS -->
	<script src="./js/demo.js"></script>

</body>

</html>
